name: Vavoo GÃ¼ncelleyici

on:
  schedule:
    - cron: '0 */2 * * *'  # Her 2 saatte bir
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update:
    runs-on: ubuntu-latest

    steps:
    - name: Repoyu al
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # TÃ¼m commit geÃ§miÅŸini al

    - name: Python kur
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: Gerekli paketleri yÃ¼kle
      run: pip install requests APScheduler m3u8

    - name: Botu Ã§alÄ±ÅŸtÄ±r
      run: python bot.py

    - name: DeÄŸiÅŸiklik kontrolÃ¼
      id: check-changes
      run: |
        git diff --exit-code vavooall.m3u || echo "changed=true" >> $GITHUB_OUTPUT
        echo "DeÄŸiÅŸiklik durumu: ${{ steps.check-changes.outputs.changed }}"

    - name: DeÄŸiÅŸiklikleri commitle
      if: steps.check-changes.outputs.changed == 'true'
      run: |
        git config user.name "GitHub Actions"
        git config user.email "actions@users.noreply.github.com"
        git add vavooall.m3u
        git commit -m "ğŸ”„ Otomatik gÃ¼ncelleme: $(date +'%d.%m.%Y %H:%M')"
        git pushfÄ±ndan otomatik gÃ¼ncelleme"
        git push origin main
